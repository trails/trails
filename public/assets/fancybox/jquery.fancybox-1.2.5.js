/*
 * FancyBox - jQuery Plugin
 * simple and fancy lightbox alternative
 *
 * Copyright (c) 2009 Janis Skarnelis
 * Examples and documentation at: http://fancybox.net
 * 
 * Version: 1.2.5 (03/11/2009)
 * Requires: jQuery v1.3+
 * 
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(e){e.fn.fixPNG=function(){return this.each(function(){var t=e(this).css("backgroundImage");t.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(t=RegExp.$1,e(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod="+(e(this).css("backgroundRepeat")=="no-repeat"?"crop":"scale")+", src='"+t+"')"}).each(function(){var t=e(this).css("position");t!="absolute"&&t!="relative"&&e(this).css("position","relative")}))})};var t,n,r=!1,i=new Image,s,o=1,u=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,a=null,f=e.browser.msie&&e.browser.version.substr(0,1)==6&&!window.XMLHttpRequest,l=f||e.browser.msie&&e.browser.version.substr(0,1)==7;e.fn.fancybox=function(s){function h(){return t=this,n=e.extend({},o),p(),!1}function p(){if(r)return;e.isFunction(n.callbackOnStart)&&n.callbackOnStart(),n.itemArray=[],n.itemCurrent=0;if(o.itemArray.length>0)n.itemArray=o.itemArray;else{var i={};if(!t.rel||t.rel==""){var i={href:t.href,title:t.title};e(t).children("img:first").length?i.orig=e(t).children("img:first"):i.orig=e(t);if(i.title==""||typeof i.title=="undefined")i.title=i.orig.attr("alt");n.itemArray.push(i)}else{var s=e(c).filter("a[rel="+t.rel+"]"),i={};for(var u=0;u<s.length;u++){i={href:s[u].href,title:s[u].title},e(s[u]).children("img:first").length?i.orig=e(s[u]).children("img:first"):i.orig=e(s[u]);if(i.title==""||typeof i.title=="undefined")i.title=i.orig.attr("alt");n.itemArray.push(i)}}}while(n.itemArray[n.itemCurrent].href!=t.href)n.itemCurrent++;n.overlayShow&&(f&&(e("embed, object, select").css("visibility","hidden"),e("#fancy_overlay").css("height",e(document).height())),e("#fancy_overlay").css({"background-color":n.overlayColor,opacity:n.overlayOpacity}).show()),e(window).bind("resize.fb scroll.fb",e.fn.fancybox.scrollBox),d()}function d(){e("#fancy_right, #fancy_left, #fancy_close, #fancy_title").hide();var r=n.itemArray[n.itemCurrent].href;if(r.match("iframe")||t.className.indexOf("iframe")>=0)e.fn.fancybox.showLoading(),g('<iframe id="fancy_frame" onload="jQuery.fn.fancybox.showIframe()" name="fancy_iframe'+Math.round(Math.random()*1e3)+'" frameborder="0" hspace="0" src="'+r+'"></iframe>',n.frameWidth,n.frameHeight);else if(r.match(/#/)){var s=window.location.href.split("#")[0];s=r.replace(s,""),s=s.substr(s.indexOf("#")),g('<div id="fancy_div">'+e(s).html()+"</div>",n.frameWidth,n.frameHeight)}else r.match(u)?(i=new Image,i.src=r,i.complete?v():(e.fn.fancybox.showLoading(),e(i).unbind().bind("load",function(){e("#fancy_loading").hide(),v()}))):(e.fn.fancybox.showLoading(),e.get(r,function(t){e("#fancy_loading").hide(),g('<div id="fancy_ajax">'+t+"</div>",n.frameWidth,n.frameHeight)}))}function v(){var t=i.width,r=i.height,s=n.padding*2+40,o=n.padding*2+60,u=e.fn.fancybox.getViewport();if(n.imageScale&&(t>u[0]-s||r>u[1]-o)){var a=Math.min(Math.min(u[0]-s,t)/t,Math.min(u[1]-o,r)/r);t=Math.round(a*t),r=Math.round(a*r)}g('<img alt="" id="fancy_img" src="'+i.src+'" />',t,r)}function m(){if(n.itemArray.length-1>n.itemCurrent){var e=n.itemArray[n.itemCurrent+1].href;e.match(u)&&(objNext=new Image,objNext.src=e)}if(n.itemCurrent>0){var e=n.itemArray[n.itemCurrent-1].href;e.match(u)&&(objNext=new Image,objNext.src=e)}}function g(t,i,s){r=!0;var o=n.padding;if(l||a)e("#fancy_content")[0].style.removeExpression("height"),e("#fancy_content")[0].style.removeExpression("width");if(o>0){i+=o*2,s+=o*2,e("#fancy_content").css({top:o+"px",right:o+"px",bottom:o+"px",left:o+"px",width:"auto",height:"auto"});if(l||a)e("#fancy_content")[0].style.setExpression("height","(this.parentNode.clientHeight - "+o*2+")"),e("#fancy_content")[0].style.setExpression("width","(this.parentNode.clientWidth - "+o*2+")")}else e("#fancy_content").css({top:0,right:0,bottom:0,left:0,width:"100%",height:"100%"});if(e("#fancy_outer").is(":visible")&&i==e("#fancy_outer").width()&&s==e("#fancy_outer").height()){e("#fancy_content").fadeOut("fast",function(){e("#fancy_content").empty().append(e(t)).fadeIn("normal",function(){b()})});return}var u=e.fn.fancybox.getViewport(),f=s+60>u[1]?u[3]:u[3]+Math.round((u[1]-s-60)*.5),c=i+40>u[0]?u[2]:u[2]+Math.round((u[0]-i-40)*.5),h={left:c,top:f,width:i+"px",height:s+"px"};if(e("#fancy_outer").is(":visible"))e("#fancy_content").fadeOut("normal",function(){e("#fancy_content").empty(),e("#fancy_outer").animate(h,n.zoomSpeedChange,n.easingChange,function(){e("#fancy_content").append(e(t)).fadeIn("normal",function(){b()})})});else if(n.zoomSpeedIn>0&&n.itemArray[n.itemCurrent].orig!==undefined){e("#fancy_content").empty().append(e(t));var p=n.itemArray[n.itemCurrent].orig,d=e.fn.fancybox.getPosition(p);e("#fancy_outer").css({left:d.left-20-n.padding+"px",top:d.top-20-n.padding+"px",width:e(p).width()+n.padding*2,height:e(p).height()+n.padding*2}),n.zoomOpacity&&(h.opacity="show"),e("#fancy_outer").animate(h,n.zoomSpeedIn,n.easingIn,function(){b()})}else e("#fancy_content").hide().empty().append(e(t)).show(),e("#fancy_outer").css(h).fadeIn("normal",function(){b()})}function y(){n.itemCurrent!=0&&(e("#fancy_left, #fancy_left_ico").unbind().bind("click",function(e){return e.stopPropagation(),n.itemCurrent--,d(),!1}),e("#fancy_left").show()),n.itemCurrent!=n.itemArray.length-1&&(e("#fancy_right, #fancy_right_ico").unbind().bind("click",function(e){return e.stopPropagation(),n.itemCurrent++,d(),!1}),e("#fancy_right").show())}function b(){e.browser.msie&&(e("#fancy_content")[0].style.removeAttribute("filter"),e("#fancy_outer")[0].style.removeAttribute("filter")),y(),m(),e(document).bind("keydown.fb",function(t){t.keyCode==27&&n.enableEscapeButton?e.fn.fancybox.close():t.keyCode==37&&n.itemCurrent!=0?(e(document).unbind("keydown.fb"),n.itemCurrent--,d()):t.keyCode==39&&n.itemCurrent!=n.itemArray.length-1&&(e(document).unbind("keydown.fb"),n.itemCurrent++,d())}),n.centerOnScroll&&e(window).bind("resize.fb scroll.fb",e.fn.fancybox.scrollBox),n.hideOnContentClick&&e("#fancy_content").click(e.fn.fancybox.close),n.overlayShow&&n.hideOnOverlayClick&&e("#fancy_overlay").bind("click",e.fn.fancybox.close),n.showCloseButton&&e("#fancy_close").bind("click",e.fn.fancybox.close).show();if(typeof n.itemArray[n.itemCurrent].title!="undefined"&&n.itemArray[n.itemCurrent].title.length>0){var t=e("#fancy_outer").position();e("#fancy_title div").text(n.itemArray[n.itemCurrent].title).html(),e("#fancy_title").css({top:t.top+e("#fancy_outer").outerHeight()-32,left:t.left+(e("#fancy_outer").outerWidth()*.5-e("#fancy_title").width()*.5)}).show()}n.overlayShow&&f&&e("embed, object, select",e("#fancy_content")).css("visibility","visible"),e.isFunction(n.callbackOnShow)&&n.callbackOnShow(n.itemArray[n.itemCurrent]),e.browser.msie&&(e("#fancy_outer")[0].style.removeAttribute("filter"),e("#fancy_content")[0].style.removeAttribute("filter")),r=!1}var o=e.extend({},e.fn.fancybox.defaults,s),c=this;return this.unbind("click.fb").bind("click.fb",h)},e.fn.fancybox.scrollBox=function(){var t=e.fn.fancybox.getViewport();if(e("#fancy_outer").is(":visible")){var n=e("#fancy_outer").outerWidth(),r=e("#fancy_outer").outerHeight(),i={top:r>t[1]?t[3]:t[3]+Math.round((t[1]-r)*.5),left:n>t[0]?t[2]:t[2]+Math.round((t[0]-n)*.5)};e("#fancy_outer").css(i),e("#fancy_title").css({top:i.top+r-32,left:i.left+(n*.5-e("#fancy_title").width()*.5)})}f&&e("#fancy_overlay").is(":visible")&&e("#fancy_overlay").css({height:e(document).height()}),e("#fancy_loading").is(":visible")&&e("#fancy_loading").css({left:(t[0]-40)*.5+t[2],top:(t[1]-40)*.5+t[3]})},e.fn.fancybox.getNumeric=function(t,n){return parseInt(e.curCSS(t.jquery?t[0]:t,n,!0))||0},e.fn.fancybox.getPosition=function(t){var n=t.offset();return n.top+=e.fn.fancybox.getNumeric(t,"paddingTop"),n.top+=e.fn.fancybox.getNumeric(t,"borderTopWidth"),n.left+=e.fn.fancybox.getNumeric(t,"paddingLeft"),n.left+=e.fn.fancybox.getNumeric(t,"borderLeftWidth"),n},e.fn.fancybox.showIframe=function(){e("#fancy_loading").hide(),e("#fancy_frame").show()},e.fn.fancybox.getViewport=function(){return[e(window).width(),e(window).height(),e(document).scrollLeft(),e(document).scrollTop()]},e.fn.fancybox.animateLoading=function(){if(!e("#fancy_loading").is(":visible")){clearInterval(s);return}e("#fancy_loading > div").css("top",o*-40+"px"),o=(o+1)%12},e.fn.fancybox.showLoading=function(){clearInterval(s);var t=e.fn.fancybox.getViewport();e("#fancy_loading").css({left:(t[0]-40)*.5+t[2],top:(t[1]-40)*.5+t[3]}).show(),e("#fancy_loading").bind("click",e.fn.fancybox.close),s=setInterval(e.fn.fancybox.animateLoading,66)},e.fn.fancybox.close=function(){r=!0,e(i).unbind(),e(document).unbind("keydown.fb"),e(window).unbind("resize.fb scroll.fb"),e("#fancy_overlay, #fancy_content, #fancy_close").unbind(),e("#fancy_close, #fancy_loading, #fancy_left, #fancy_right, #fancy_title").hide(),__cleanup=function(){e("#fancy_overlay").is(":visible")&&e("#fancy_overlay").fadeOut("fast"),e("#fancy_content").empty(),n.centerOnScroll&&e(window).unbind("resize.fb scroll.fb"),f&&e("embed, object, select").css("visibility","visible"),e.isFunction(n.callbackOnClose)&&n.callbackOnClose(),r=!1};if(e("#fancy_outer").is(":visible")!==!1)if(n.zoomSpeedOut>0&&n.itemArray[n.itemCurrent].orig!==undefined){var t=n.itemArray[n.itemCurrent].orig,s=e.fn.fancybox.getPosition(t),o={left:s.left-20-n.padding+"px",top:s.top-20-n.padding+"px",width:e(t).width()+n.padding*2,height:e(t).height()+n.padding*2};n.zoomOpacity&&(o.opacity="hide"),e("#fancy_outer").stop(!1,!0).animate(o,n.zoomSpeedOut,n.easingOut,__cleanup)}else e("#fancy_outer").stop(!1,!0).fadeOut("fast",__cleanup);else __cleanup();return!1},e.fn.fancybox.build=function(){var t="";t+='<div id="fancy_overlay"></div>',t+='<div id="fancy_loading"><div></div></div>',t+='<div id="fancy_outer">',t+='<div id="fancy_inner">',t+='<div id="fancy_close"></div>',t+='<div id="fancy_bg"><div class="fancy_bg" id="fancy_bg_n"></div><div class="fancy_bg" id="fancy_bg_ne"></div><div class="fancy_bg" id="fancy_bg_e"></div><div class="fancy_bg" id="fancy_bg_se"></div><div class="fancy_bg" id="fancy_bg_s"></div><div class="fancy_bg" id="fancy_bg_sw"></div><div class="fancy_bg" id="fancy_bg_w"></div><div class="fancy_bg" id="fancy_bg_nw"></div></div>',t+='<a href="javascript:;" id="fancy_left"><span class="fancy_ico" id="fancy_left_ico"></span></a><a href="javascript:;" id="fancy_right"><span class="fancy_ico" id="fancy_right_ico"></span></a>',t+='<div id="fancy_content"></div>',t+="</div>",t+="</div>",t+='<div id="fancy_title"></div>',e(t).appendTo("body"),e('<table cellspacing="0" cellpadding="0" border="0"><tr><td class="fancy_title" id="fancy_title_left"></td><td class="fancy_title" id="fancy_title_main"><div></div></td><td class="fancy_title" id="fancy_title_right"></td></tr></table>').appendTo("#fancy_title"),e.browser.msie&&e(".fancy_bg").fixPNG();if(f){e("div#fancy_overlay").css("position","absolute"),e("#fancy_loading div, #fancy_close, .fancy_title, .fancy_ico").fixPNG(),e("#fancy_inner").prepend('<iframe id="fancy_bigIframe" src="javascript:false;" scrolling="no" frameborder="0"></iframe>');var n=e("#fancy_bigIframe")[0].contentWindow.document;n.open(),n.close()}},e.fn.fancybox.defaults={padding:10,imageScale:!0,zoomOpacity:!0,zoomSpeedIn:0,zoomSpeedOut:0,zoomSpeedChange:300,easingIn:"swing",easingOut:"swing",easingChange:"swing",frameWidth:560,frameHeight:340,overlayShow:!0,overlayOpacity:.3,overlayColor:"#666",enableEscapeButton:!0,showCloseButton:!0,hideOnOverlayClick:!0,hideOnContentClick:!0,centerOnScroll:!0,itemArray:[],callbackOnStart:null,callbackOnShow:null,callbackOnClose:null},e(document).ready(function(){a=e.browser.msie&&!e.boxModel,e("#fancy_outer").length<1&&e.fn.fancybox.build()})})(jQuery);